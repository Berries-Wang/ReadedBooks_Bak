# Dockerfile构建镜像
## 为什么使用Dockerfile来构建镜像
+ 镜像的制作其实就是定制每一层所需要添加的配置、文件。如果可以将每一层的修改、安装、构建、操作的命令都写入到一个脚本之中，用这个脚本来构建、定制镜像，那么之前的无法重复的问题、镜像构建透明性的问题、体积的问题都会被解决。
## Dockerfile是什么？
+ Dockerfile是一个文本文件，其内包含了一条条的指令。**每一条指令构建一层，因此每一条指令的内容，就是描述该层当如何构建**
   - 请注意：每一条Dockerfile指令都会构建一层，也就是说，每次执行一条Dockerfile指令，该定制的镜像就会增加一层。又因为镜像的操作只会改变当前层，不会改变上一层的镜像。因此，在使用Dockerfile指令的时候，应该将尽量多的操作放到一个Dockerfile指令中执行。
       + 例如，构建redis镜像，涉及到安装gcc环境 -> 下载redis源码 -> 解压 -> 编译 -> 删除源码包 -> 删除依赖等。如果将这每一个操作都使用一条Dockerfile指令来进行，这会导致该镜像存在多层（不必要的）。如下图：
         <img src ="./pics/dockerfile_more.png"/>
       + 也因为每一条Dockerfile指令会构建一层镜像，且在每一层上的任何改变都只会发生在自己这一层。即此时就要考虑尽可能将多的操作放到一条Dockerfile指令中执行。如下
          <img src ="./pics/dockerfile-single.png"/>